<Window x:Class="NutritionOptimizer.UI.Views.NutrientChartWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="영양소 달성률 차트"
        Height="600"
        Width="900"
        WindowStartupLocation="CenterOwner">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- 제목 -->
        <TextBlock Grid.Row="0"
                   Text="영양소 달성률"
                   FontSize="20"
                   FontWeight="Bold"
                   Margin="0 0 0 12" />

        <!-- 범례 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0 0 0 16">
            <Border Background="#4CAF50" Width="20" Height="20" CornerRadius="3" Margin="0 0 8 0" />
            <TextBlock Text="목표 달성" VerticalAlignment="Center" Margin="0 0 20 0" />
            
            <Border Background="#FF9800" Width="20" Height="20" CornerRadius="3" Margin="0 0 8 0" />
            <TextBlock Text="목표 미달" VerticalAlignment="Center" Margin="0 0 20 0" />
            
            <Border Background="#F44336" Width="20" Height="20" CornerRadius="3" Margin="0 0 8 0" />
            <TextBlock Text="목표 초과" VerticalAlignment="Center" />
        </StackPanel>

        <!-- 차트 영역 -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
            <ItemsControl ItemsSource="{Binding ChartItems}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="0 0 0 20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="160" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="140" />
                            </Grid.ColumnDefinitions>

                            <!-- 영양소 이름 -->
                            <TextBlock Grid.Column="0" 
                                       Text="{Binding NutrientName}"
                                       VerticalAlignment="Center"
                                       FontWeight="SemiBold"
                                       FontSize="13" />

                            <!-- 막대 그래프 -->
                            <Grid Grid.Column="1" Height="35">
                                <!-- 배경 (회색) -->
                                <Border Background="#E0E0E0" 
                                        CornerRadius="4"
                                        Height="35" />

                                <!-- 실제 달성 막대 -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="{Binding BarWidthStar}" />
                                        <ColumnDefinition Width="*" />
                                    </Grid.ColumnDefinitions>

                                    <Border Grid.Column="0"
                                            Background="{Binding BarColor}"
                                            CornerRadius="4"
                                            Height="35"
                                            Margin="0">
                                        <!-- 달성률 텍스트 -->
                                        <TextBlock Text="{Binding PercentageText}"
                                                   HorizontalAlignment="Right"
                                                   VerticalAlignment="Center"
                                                   Margin="0 0 10 0"
                                                   FontWeight="Bold"
                                                   Foreground="White"
                                                   FontSize="13" />
                                    </Border>
                                </Grid>
                            </Grid>

                            <!-- 수치 정보 -->
                            <StackPanel Grid.Column="2" 
                                        Orientation="Vertical"
                                        VerticalAlignment="Center"
                                        Margin="16 0 0 0">
                                <TextBlock FontSize="12">
                                    <Run Text="실제: " FontWeight="SemiBold" />
                                    <Run Text="{Binding ActualValueText}" />
                                </TextBlock>
                                <TextBlock FontSize="12">
                                    <Run Text="목표: " FontWeight="SemiBold" />
                                    <Run Text="{Binding TargetRangeText}" />
                                </TextBlock>
                            </StackPanel>
                        </Grid>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</Window>
