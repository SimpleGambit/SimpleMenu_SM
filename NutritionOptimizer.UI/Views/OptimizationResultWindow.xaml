<Window x:Class="NutritionOptimizer.UI.Views.OptimizationResultWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="최적화 결과"
        Height="750"
        Width="1000"
        WindowStartupLocation="CenterOwner">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- 제목 -->
        <TextBlock Grid.Row="0"
                   Text="🎯 최적화 결과"
                   FontSize="24"
                   FontWeight="Bold"
                   Margin="0 0 0 12" />

        <!-- 요약 정보 (영양 점수, 총 비용) -->
        <Border Grid.Row="1" 
                Background="#F0F8FF"
                BorderBrush="#4A90E2"
                BorderThickness="2"
                CornerRadius="8"
                Padding="16"
                Margin="0 0 0 16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- 영양 점수 -->
                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                    <TextBlock Text="영양 점수" 
                               FontSize="14" 
                               Foreground="Gray"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="{Binding NutritionScore, StringFormat={}{0:N1}/100}"
                               FontSize="32" 
                               FontWeight="Bold"
                               Foreground="#2ECC71"
                               HorizontalAlignment="Center"
                               Margin="0 4 0 0" />
                </StackPanel>

                <!-- 총 비용 -->
                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                    <TextBlock Text="총 비용" 
                               FontSize="14" 
                               Foreground="Gray"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="{Binding TotalCost, StringFormat=₩{0:N0}}" 
                               FontSize="32" 
                               FontWeight="Bold"
                               Foreground="#4A90E2"
                               HorizontalAlignment="Center"
                               Margin="0 4 0 0" />
                </StackPanel>

                <!-- 음식 개수 -->
                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                    <TextBlock Text="선택된 음식" 
                               FontSize="14" 
                               Foreground="Gray"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="{Binding Picks.Count, StringFormat={}{0}개}" 
                               FontSize="32" 
                               FontWeight="Bold"
                               Foreground="#E67E22"
                               HorizontalAlignment="Center"
                               Margin="0 4 0 0" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- 선택된 음식 -->
        <GroupBox Grid.Row="2" Header="선택된 음식" Margin="0 0 0 12" FontWeight="Bold">
            <DataGrid ItemsSource="{Binding Picks}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      HeadersVisibility="Column"
                      AlternatingRowBackground="#F9F9F9"
                      GridLinesVisibility="Horizontal"
                      RowHeight="32">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="음식 이름" Binding="{Binding FoodName}" Width="*" />
                    <DataGridTextColumn Header="양 (g)" Binding="{Binding AmountG, StringFormat={}{0:N1}}" Width="120" />
                    <DataGridTextColumn Header="비용 (원)" Binding="{Binding Cost, StringFormat={}{0:N0}}" Width="120" />
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- 영양소 달성 -->
        <GroupBox Grid.Row="3" Header="영양소 달성 현황" Margin="0 0 0 12" FontWeight="Bold">
            <DataGrid ItemsSource="{Binding NutrientSummary}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True"
                      HeadersVisibility="Column"
                      AlternatingRowBackground="#F9F9F9"
                      GridLinesVisibility="Horizontal"
                      RowHeight="32">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="영양소" Binding="{Binding Key, Converter={StaticResource NutrientKeyConverter}}" Width="*" />
                    <DataGridTextColumn Header="달성량" Binding="{Binding Actual, StringFormat={}{0:N1}}" Width="100" />
                    <DataGridTextColumn Header="목표" Binding="{Binding Target, StringFormat={}{0:N1}}" Width="100" />
                    <DataGridTextColumn Header="최소" Binding="{Binding Min, StringFormat={}{0:N0}}" Width="80" />
                    <DataGridTextColumn Header="최대" Binding="{Binding Max, StringFormat={}{0:N0}}" Width="80" />
                    <DataGridTextColumn Header="달성률" Binding="{Binding AchievementRate, StringFormat={}{0:N1}%}" Width="100">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="HorizontalAlignment" Value="Center" />
                                <Setter Property="FontWeight" Value="SemiBold" />
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- 하단 버튼들 -->
        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <Button Grid.Column="2"
                    Content="💾 식단 저장"
                    Width="120"
                    Height="40"
                    Margin="0 0 12 0"
                    Click="SaveButton_Click"
                    FontSize="14" />
            
            <Button Grid.Column="3"
                    Content="닫기"
                    Width="100"
                    Height="40"
                    Click="CloseButton_Click"
                    FontSize="14" />
        </Grid>
    </Grid>
</Window>
